# Choleskyåˆ†è§£ {Cholesky decomposition}

Cholesky åº”è¯¥æ€ä¹ˆå¿µï¼Œo(â•¯â–¡â•°)oï¼Œå¬åˆ«äººå¿µæ¯”è¾ƒåƒâ€˜ç…ä¹æ­»éª‘â€™ï¼Œæ¯•ç«Ÿè¿™æ˜¯ğŸ‡«ğŸ‡·åå­—ï¼Œå“ˆå“ˆå“ˆå“ˆ

## $A^{T}A$


è¿™ä¸ªçŸ©é˜µéå¸¸é‡è¦ï¼Œä¹‹å‰åœ¨[æœ€å°äºŒä¹˜æ³•](https://zhuanlan.zhihu.com/p/89373759)ä¹Ÿè§è¿‡å®ƒï¼Œå¦‚æœï¼š

$$A\mathbf{x} = \mathbf{b}$$

æ— è§£ï¼Œä¹Ÿå°±æ˜¯ $x= A^{-1}\mathbf{b}$ ä¸æˆç«‹ï¼Œ A ä¸å¯é€†ï¼Œæˆ‘ä»¬æ— æ³•è®¡ç®— $A^{-1}$.


é‚£ä¹ˆæˆ‘ä»¬ä¼šæƒ³è¦æœ€å°åŒ–ï¼š

$$||A\mathbf{x} - \mathbf{b} ||_2$$

ä¹Ÿå°±æ˜¯ï¼š



\begin{align*}
|| A\mathbf{x} - \mathbf{b} ||^2 {}
&= (A\mathbf{x} - \mathbf{b})\cdot(A\mathbf{x} - \mathbf{b}) \\
&= (A\mathbf{x} - \mathbf{b})^T \cdot (A\mathbf{x} - \mathbf{b}) \\
&= (\mathbf{x}^TA^T - \mathbf{b}^T) \cdot (A\mathbf{x} - \mathbf{b})\\
&= (\mathbf{x}^TA^TA\mathbf{x} - 2\mathbf{b}^TA\mathbf{x} + \mathbf{b}^T\mathbf{b}) 
\end{align*}


è¿™ä¸ª Error å‡½æ•°å¯¹ $\mathbf{x}$ æ±‚å¯¼ï¼š

$$
\frac{\partial E}{\partial \mathbf{x}} =  2A^TA\mathbf{x} - 2 A^T \mathbf{b}= 0
$$

ä¹Ÿå°±æ˜¯éœ€è¦è§£ï¼š

$$
A^TA\mathbf{x} = A^T \mathbf{b} \tag{1}
$$

(1)è¯¦ç»†æ¨å¯¼è¿‡ç¨‹å¯ä»¥å‚è§ï¼š[least\_squares\_SP](http://eeweb.poly.edu/iselesni/lecture_notes/least_squares/least_squares_SP.pdf)


(1)å¼ä¹Ÿå°±æ˜¯ï¼š

$$
\mathbf{x} = (A^TA)^{-1} A^T \mathbf{b}  \tag{2}
$$


(1)å¼ ä¸€å®šå¯ä»¥æ¨å‡º (2) å¼ä¹ˆï¼Ÿ $(A^TA)^{-1}$ ä¸€å®šå­˜åœ¨é€†çŸ©é˜µä¹ˆï¼Ÿä¹Ÿè®¸ä¸ä¸€å®š,ä¸ä¸€å®šçš„åŸå› æ˜¯æ¯”å¦‚ A ä¸æ˜¯æ–¹é˜µï¼Œé‚£ä¹ˆ $A^TA$ å°±å¯èƒ½åªæ˜¯åŠæ­£å®šï¼Œæ‰€ä»¥é€†çŸ©é˜µä¸å­˜åœ¨ï¼Œæ‰€ä»¥æ‰æœ‰[Tikhonov regularization](https://en.wikipedia.org/wiki/Tikhonov_regularization)


## å¯¹ç§°

å¯¹ç§°ï¼Œé¦–å…ˆ $A^TA$ æ˜¯å¯¹ç§°é˜µï¼Œè®°å¾— $(AB)^T = B^TA^T$ï¼š

$$(A^TA)^T  = A^T (A^T)^T = A^TA$$

å®ƒçš„è½¬ç½®ç­‰äºè‡ªèº«ï¼Œæ‰€ä»¥å¯¹ç§°ã€‚

## æ­£å®šçŸ©é˜µ

å…ˆçœ‹å®šä¹‰ï¼š

$$
{\displaystyle M{\text{ä¸ºæ­£å®šçŸ©é˜µ}}\quad \iff \quad x^{\textsf {T}}Mx>0{\text{ for all }}x\in \mathbb {R} ^{n}\setminus \mathbf {0} }
$$

$$
{\displaystyle M{\text{ä¸ºåŠæ­£å®šçŸ©é˜µ}}\quad \iff \quad x^{\textsf {T}}Mx \ge 0{\text{ for all }}x\in \mathbb {R} ^{n}}
$$

è¿™é‡Œçš„ A æˆ‘ä»¬æš‚æ—¶åªè€ƒè™‘å®ƒæ˜¯å®æ•°çŸ©é˜µå†…ï¼Œå¦‚æœAæ˜¯æ»¡ç§©çš„æ–¹é˜µï¼Œé‚£ä¹ˆ $A^TA$ ä¸ºæ­£å®šçŸ©é˜µ:

$$x^TA^TAx = (Ax)^T \cdot Ax = ||Ax||^2$$

å¯¹äºå®æ­£å®šçŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥æœ‰Choleskyåˆ†è§£ã€‚


## Choleskyåˆ†è§£


å½“ A æ˜¯ä¸€ä¸ªSPD (real Symmetric positive definite matrixï¼‰çš„æ—¶å€™ï¼Œæ³¨æ„è¿™é‡Œçš„A ä¸æ˜¯ä¸Šé¢çš„ Aï¼ˆåªæ˜¯æˆ‘ç”¨äº†åŒä¸€ä¸ªå­—æ¯ï¼‰ï¼Œå°±å¯ä»¥åˆ†è§£æˆ lower triangle çŸ©é˜µ L å’Œå®ƒçš„è½¬ç½®ä¹Ÿå°±æ˜¯ upper triangle $L^T$.

![](images/Cholesky_ALL.png)


å¯ä»¥ç”¨å½’çº³æ³•è¯æ˜è¿™ä¸ªåˆ†è§£æ˜¯ä¸€å®šå­˜åœ¨å¹¶ä¸”æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥å‚è§ï¼š

[How to prove the existence and uniqueness of Cholesky decomposition?](https://math.stackexchange.com/questions/2509810/how-to-prove-the-existence-and-uniqueness-of-cholesky-decomposition)



ä¹‹å‰çš„é«˜æ–¯æ¶ˆå…ƒæ³•ä¸­æˆ‘ä»¬å†™è¿‡ï¼š

$$
A = PLU
$$


å½“Aæ­£å®šçš„æ—¶å€™ï¼š

$$
A = LL^T
$$

åœ¨å®é™…ä¸­ï¼Œå¦‚æœçŸ©é˜µæ˜¯æ­£å®šçš„ï¼Œä½¿ç”¨ Choleskyåˆ†è§£ ä¼šæ¯” LUåˆ†è§£ æ›´åŠ é«˜æ•ˆï¼Œæ›´åŠ æ•°å€¼ç¨³å®šã€‚

## è®¡ç®—

$$
\begin{aligned}
\left({\begin{array}{*{3}{r}}4&12&-16\\12&37&-43\\-16&-43&98\\\end{array}}\right)=\left({\begin{array}{*{3}{r}}2&0&0\\6&1&0\\-8&5&3\\\end{array}}\right)\left({\begin{array}{*{3}{r}}2&6&-8\\0&1&5\\0&0&3\\\end{array}}\right)
\end{aligned}
$$


è®¡ç®—çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ `scipy.linalg.cholesky`


```python
import numpy as np
from scipy import linalg

a = np.array([[4, 12, -16],
              [12, 37, -43],
              [-16, -43, 98]])
              
L = linalg.cholesky(a, lower=True) # é»˜è®¤è®¡ç®— upperï¼Œ æ‰€ä»¥æŒ‡å®š lower = True

# array([[ 2.,  0.,  0.],
#       [ 6.,  1.,  0.],
#       [-8.,  5.,  3.]])

np.allclose(np.dot(L, L.T) , a) # éªŒè¯è®¡ç®—
```
